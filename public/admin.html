<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin | Etago Dashboards</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="demo-banner">
    Demo environment â€” authentication, roles, and themes are simulated client-side only.
  </div>

  <header class="navbar">
    <div class="inner">
      <div class="brand">
        <span class="dot"></span> Etago Dashboards
      </div>
      <nav class="navlinks">
        <a href="index.html">Home</a>
        <a href="dashboard1.html" data-dashboard="dashboard1.html">Dashboard 1</a>
        <a href="dashboard2.html" data-dashboard="dashboard2.html">Dashboard 2</a>
        <a href="dashboard3.html" data-dashboard="dashboard3.html">Dashboard 3</a>

        <a href="login.html" class="nav-logged-out">Login</a>
        <a href="profile.html" class="nav-logged-in">
          Profile (<span class="nav-username"></span>)
        </a>
        <a href="admin.html" class="nav-logged-in">Admin</a>

        <button type="button" id="theme-toggle" class="nav-theme-btn nav-logged-in">
          ðŸŒ“ Theme
        </button>

        <button type="button" class="nav-logged-in btn-secondary" onclick="logout()">
          Logout
        </button>
      </nav>
    </div>
  </header>

  <main class="page-container">
    <section class="card">
      <h1>Admin Console (Mock)</h1>
      <p class="muted">
        This page demonstrates how admin-level controls could look in a real deployment.
        On GitHub Pages, this is purely a front-end mockup.
      </p>

      <h2>Users &amp; Roles</h2>
      <table class="data-table" id="user-table">
        <thead>
          <tr>
            <th>Username</th>
            <th>Role</th>
            <th>Dashboards</th>
            <th>Promote/Demote</th>
          </tr>
        </thead>
        <tbody>
          <!-- Filled by JS -->
        </tbody>
      </table>
    </section>

    <section class="card">
      <h2>Basic Security Protocols (Conceptual)</h2>
      <p class="muted">
        These are the kinds of controls that would be implemented server-side in a real app:
      </p>
      <ul class="security-list">
        <li><strong>Authentication:</strong> Secure session cookies or JWTs, not <code>localStorage</code>, for real user auth.</li>
        <li><strong>Password storage:</strong> Hash passwords with bcrypt/Argon2; never store them in plain text.</li>
        <li><strong>RBAC:</strong> Enforce roles on the server on every request.</li>
        <li><strong>Transport security:</strong> HTTPS-only with HSTS.</li>
        <li><strong>Input validation:</strong> Server-side validation & sanitization to prevent injection attacks.</li>
        <li><strong>Audit logging:</strong> Log admin actions like role changes and access to sensitive data.</li>
        <li><strong>Least privilege:</strong> Only grant the minimum rights needed per user.</li>
      </ul>
    </section>
  </main>

  <script src="auth.js"></script>
  <script src="theme.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      requireAdmin();

      const userTableBody = document.querySelector("#user-table tbody");

      // Clone the mock users for display (no real persistence)
      const mockUsers = [
        {
          username: "admin",
          role: "admin",
          dashboards: ["dashboard1.html", "dashboard2.html", "dashboard3.html", "dashboard4.html"]
        },
        {
          username: "jjparkerlee",
          role: "user",
          dashboards: ["dashboard2.html", "dashboard3.html"]
        }
      ];

      function renderTable() {
        userTableBody.innerHTML = "";
        mockUsers.forEach((u, index) => {
          const tr = document.createElement("tr");

          const tdUser = document.createElement("td");
          tdUser.textContent = u.username;

          const tdRole = document.createElement("td");
          tdRole.textContent = u.role;
          tdRole.className = u.role === "admin" ? "badge badge-admin" : "badge badge-user";

          const tdDash = document.createElement("td");
          tdDash.textContent = u.dashboards.join(", ");

          const tdAction = document.createElement("td");
          const btn = document.createElement("button");
          btn.textContent = u.role === "admin" ? "Demote to user (mock)" : "Promote to admin (mock)";
          btn.className = "btn-secondary";
          btn.addEventListener("click", () => {
            mockUsers[index].role = u.role === "admin" ? "user" : "admin";
            renderTable();
          });

          tdAction.appendChild(btn);

          tr.appendChild(tdUser);
          tr.appendChild(tdRole);
          tr.appendChild(tdDash);
          tr.appendChild(tdAction);

          userTableBody.appendChild(tr);
        });
      }

      renderTable();
    });
  </script>
</body>
</html>
